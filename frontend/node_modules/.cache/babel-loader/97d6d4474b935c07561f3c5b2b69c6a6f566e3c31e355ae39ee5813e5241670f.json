{"ast":null,"code":"import React,{useState,useEffect}from'react';import axios from'axios';import API from'../api';import'./NewsFeed.css';import{getSafeImageUrl}from'../utils/imageUtils';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const NewsFeed=()=>{const[news,setNews]=useState([]);const[recommendations,setRecommendations]=useState([]);const[journalEntries,setJournalEntries]=useState([]);const[loading,setLoading]=useState(true);const[loadingRecs,setLoadingRecs]=useState(false);const[error,setError]=useState('');const[searchQuery,setSearchQuery]=useState('');const[searchResults,setSearchResults]=useState([]);const[isSearching,setIsSearching]=useState(false);const[currentPage,setCurrentPage]=useState(1);const[totalResults,setTotalResults]=useState(0);const[pageSize]=useState(10);const[searchTimeout,setSearchTimeout]=useState(null);const[recPageSize]=useState(12);const[seenUrls,setSeenUrls]=useState(new Set());const[userPreferences,setUserPreferences]=useState({likedKeywords:[],dislikedKeywords:[],preferredCategories:[]});const[recommendationVersion,setRecommendationVersion]=useState(0);const navigate=useNavigate();// Функция извлечения ключевых слов\nconst extractKeywords=function(){let title=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';let description=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'';const text=`${title} ${description}`.toLowerCase();const stopWords=new Set(['the','and','for','with','this','that','are','was']);const words=text.split(/\\W+/).filter(word=>word.length>3&&!stopWords.has(word));const keywordFrequency={};words.forEach(word=>{keywordFrequency[word]=(keywordFrequency[word]||0)+1;});return{keywords:Object.keys(keywordFrequency).sort((a,b)=>keywordFrequency[b]-keywordFrequency[a]).slice(0,5)};};const handlePageChange=newPage=>{if(newPage>0&&newPage<=Math.ceil(totalResults/pageSize)){handleSearch(searchQuery,newPage);window.scrollTo({top:0,behavior:'smooth'});}};// Вместо прямых запросов к NewsAPI делайте так:\nconst fetchNews=async()=>{try{const response=await API.get('/api/news/proxy/newsapi',{params:{endpoint:'top-headlines',country:'us'}});setNews(response.data.articles);}catch(err){setError('Ошибка при загрузке новостей');console.error(err);}finally{setLoading(false);}};const handleSearch=async function(query){let page=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;if(!query.trim()){setSearchResults([]);setTotalResults(0);return;}setIsSearching(true);try{var _response$data;const response=await API.get('/api/news/proxy/newsapi',{params:{endpoint:'everything',q:query,page,pageSize:pageSize}});if((_response$data=response.data)!==null&&_response$data!==void 0&&_response$data.articles){setSearchResults(response.data.articles);setTotalResults(response.data.totalResults);setCurrentPage(page);}else{setSearchResults([]);setTotalResults(0);}}catch(err){console.error('Search error:',err);setSearchResults([]);setTotalResults(0);}finally{setIsSearching(false);}};const handleSearchChange=e=>{const query=e.target.value;setSearchQuery(query);setCurrentPage(1);// Очищаем предыдущий таймер\nif(searchTimeout){clearTimeout(searchTimeout);}// Устанавливаем новый таймер только если запрос достаточно длинный\nif(query.length>2){const timeoutId=setTimeout(()=>{handleSearch(query,1);},2000);setSearchTimeout(timeoutId);}else{setSearchResults([]);setTotalResults(0);}};// Эффект для очистки таймера при размонтировании\nuseEffect(()=>{return()=>{if(searchTimeout){clearTimeout(searchTimeout);}};},[searchTimeout]);// Функция категоризации\nconst categorizeContent=function(){let title=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';let description=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'';const text=`${title} ${description}`.toLowerCase();const categories=[];if(/(tech|ai|robot|computer|software)/.test(text))categories.push('technology');if(/(business|market|economy|stock)/.test(text))categories.push('business');if(/(science|research|space|medicine)/.test(text))categories.push('science');if(/(politics|government|election)/.test(text))categories.push('politics');if(/(sport|football|basketball)/.test(text))categories.push('sports');if(/(game|gaming|esports|videogame|playstation|xbox|nintendo|steam|pc game)/.test(text))categories.push('games');return categories.length>0?categories:['general'];};const handleLikeArticle=article=>{const{keywords}=extractKeywords(article.title,article.description);setUserPreferences(prev=>({...prev,likedKeywords:[...new Set([...prev.likedKeywords,...keywords])],preferredCategories:[...new Set([...prev.preferredCategories,...categorizeContent(article.title,article.description)])]}));refreshRecommendations();};const handleDislikeArticle=article=>{const{keywords}=extractKeywords(article.title,article.description);setUserPreferences(prev=>({...prev,dislikedKeywords:[...new Set([...prev.dislikedKeywords,...keywords])]}));setRecommendations(prev=>prev.filter(item=>!keywords.some(kw=>item.title.toLowerCase().includes(kw.toLowerCase()))));refreshRecommendations();};const handleImageError=index=>{setNews(prevNews=>prevNews.filter((_,i)=>i!==index));};const handleRecImageError=index=>{setRecommendations(prevRecs=>prevRecs.filter((_,i)=>i!==index));};const fetchRecommendations=async()=>{try{const userId=localStorage.getItem('userId');if(!userId)return;setLoadingRecs(true);const journalResponse=await API.get(`/api/news/${userId}/journal`);setJournalEntries(journalResponse.data);const response=await API.get(`/api/news/recommendations/${userId}`,{params:{version:recommendationVersion,limit:recPageSize,// Теперь запрашиваем больше новостей\nlikedKeywords:userPreferences.likedKeywords.join(','),dislikedKeywords:userPreferences.dislikedKeywords.join(','),preferredCategories:userPreferences.preferredCategories.join(',')}});if(response.data){// Фильтруем дубликаты по URL\nconst uniqueRecommendations=response.data.recommendations.filter(item=>!seenUrls.has(item.url));// Обновляем множество просмотренных URL\nsetSeenUrls(prev=>{const newSet=new Set(prev);uniqueRecommendations.forEach(item=>newSet.add(item.url));return newSet;});setRecommendations(uniqueRecommendations);}}catch(err){console.error('Ошибка загрузки рекомендаций:',err);}finally{setLoadingRecs(false);}};// Обновляем функцию обновления рекомендаций\nconst refreshRecommendations=()=>{setSeenUrls(new Set());// Очищаем просмотренные URL\nsetRecommendationVersion(prev=>prev+1);};const handleAddToJournal=async newsItem=>{try{var _newsItem$source;const userId=localStorage.getItem('userId');const token=localStorage.getItem('token');if(!userId||!token){alert('Для добавления в журнал необходимо авторизоваться');return;}const{keywords}=extractKeywords(newsItem.title,newsItem.description);const categories=categorizeContent(newsItem.title,newsItem.description);// Убедимся, что все поля передаются, включая imageUrl\nconst entryData={userId,url:newsItem.url,source:((_newsItem$source=newsItem.source)===null||_newsItem$source===void 0?void 0:_newsItem$source.name)||'unknown',title:newsItem.title||'',description:newsItem.description||'',content:newsItem.content||newsItem.description||'',imageUrl:newsItem.urlToImage||newsItem.imageUrl||'',// Добавлено резервное значение\npublishedAt:newsItem.publishedAt||new Date().toISOString(),author:newsItem.author||'',keywords,categories};console.log('Отправляемые данные:',entryData);// Для отладки\nawait API.post('/api/news/journal',entryData,{headers:{Authorization:`Bearer ${token}`}});alert('Новость успешно добавлена в журнал');fetchRecommendations();}catch(err){var _err$response,_err$response$data;console.error('Ошибка добавления:',err);alert(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Ошибка при добавлении в журнал');}};const handleGoToJournal=()=>{navigate('/journal');};useEffect(()=>{fetchNews();},[]);useEffect(()=>{fetchRecommendations();},[recommendationVersion,userPreferences]);if(loading)return/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u043D\\u043E\\u0432\\u043E\\u0441\\u0442\\u0435\\u0439...\"});if(error)return/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:error});return/*#__PURE__*/_jsxs(\"div\",{className:\"news-feed\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"news-feed-header\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"news-feed-title\",children:\"\\u041D\\u043E\\u0432\\u043E\\u0441\\u0442\\u043D\\u0430\\u044F \\u043B\\u0435\\u043D\\u0442\\u0430\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u041F\\u043E\\u0438\\u0441\\u043A \\u043D\\u043E\\u0432\\u043E\\u0441\\u0442\\u0435\\u0439...\",value:searchQuery,onChange:handleSearchChange,className:\"search-input\"}),isSearching&&/*#__PURE__*/_jsx(\"div\",{className:\"search-spinner\",children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleGoToJournal,className:\"journal-button\",children:\"\\u041C\\u043E\\u0439 \\u0436\\u0443\\u0440\\u043D\\u0430\\u043B\"})]}),searchResults.length>0?/*#__PURE__*/_jsxs(\"div\",{className:\"search-results-section\",children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"search-results-title\",children:[\"\\u0420\\u0435\\u0437\\u0443\\u043B\\u044C\\u0442\\u0430\\u0442\\u044B \\u043F\\u043E\\u0438\\u0441\\u043A\\u0430 \\u043F\\u043E \\u0437\\u0430\\u043F\\u0440\\u043E\\u0441\\u0443: \\\"\",searchQuery,\"\\\" (\",totalResults,\" \\u043D\\u0430\\u0439\\u0434\\u0435\\u043D\\u043E)\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"news-grid\",children:searchResults.map((newsItem,index)=>/*#__PURE__*/_jsxs(\"article\",{className:\"news-card\",children:[newsItem.urlToImage&&/*#__PURE__*/_jsx(\"div\",{className:\"image-container\",children:/*#__PURE__*/_jsx(\"img\",{src:newsItem.urlToImage,alt:newsItem.title,className:\"news-image\",onError:()=>handleImageError(index)})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-content\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"news-title\",children:newsItem.title}),/*#__PURE__*/_jsx(\"p\",{className:\"news-description\",children:newsItem.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-footer\",children:[/*#__PURE__*/_jsx(\"a\",{href:newsItem.url,target:\"_blank\",rel:\"noopener noreferrer\",className:\"read-more\",children:\"\\u0427\\u0438\\u0442\\u0430\\u0442\\u044C \\u043F\\u043E\\u043B\\u043D\\u043E\\u0441\\u0442\\u044C\\u044E\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"action-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleLikeArticle(newsItem),className:\"like-button\",title:\"\\u041D\\u0440\\u0430\\u0432\\u0438\\u0442\\u0441\\u044F \\u044D\\u0442\\u0430 \\u0442\\u0435\\u043C\\u0430\",children:\"\\uD83D\\uDC4D\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDislikeArticle(newsItem),className:\"dislike-button\",title:\"\\u041D\\u0435 \\u043D\\u0440\\u0430\\u0432\\u0438\\u0442\\u0441\\u044F \\u044D\\u0442\\u0430 \\u0442\\u0435\\u043C\\u0430\",children:\"\\uD83D\\uDC4E\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleAddToJournal(newsItem),className:\"add-button\",children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"})]})]})]})]},`search-${index}-${Date.now()}`))}),totalResults>pageSize&&/*#__PURE__*/_jsxs(\"div\",{className:\"pagination\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handlePageChange(currentPage-1),disabled:currentPage===1||isSearching,className:\"pagination-button\",children:\"\\u041D\\u0430\\u0437\\u0430\\u0434\"}),/*#__PURE__*/_jsx(\"div\",{className:\"page-numbers\",children:Array.from({length:Math.min(5,Math.ceil(totalResults/pageSize))},(_,i)=>{let pageNum;if(Math.ceil(totalResults/pageSize)<=5){pageNum=i+1;}else if(currentPage<=3){pageNum=i+1;}else if(currentPage>=Math.ceil(totalResults/pageSize)-2){pageNum=Math.ceil(totalResults/pageSize)-4+i;}else{pageNum=currentPage-2+i;}return/*#__PURE__*/_jsx(\"button\",{onClick:()=>handlePageChange(pageNum),disabled:isSearching,className:`page-button ${currentPage===pageNum?'active':''}`,children:pageNum},pageNum);})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handlePageChange(currentPage+1),disabled:currentPage===Math.ceil(totalResults/pageSize)||isSearching,className:\"pagination-button\",children:\"\\u0412\\u043F\\u0435\\u0440\\u0435\\u0434\"})]})]}):/*#__PURE__*//* Показываем рекомендации и новости, если нет поискового запроса */_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"recommendations-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"recommendations-header\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"recommendations-title\",children:[\"\\u0420\\u0435\\u043A\\u043E\\u043C\\u0435\\u043D\\u0434\\u0443\\u0435\\u043C \\u0432\\u0430\\u043C\",loadingRecs&&/*#__PURE__*/_jsx(\"span\",{className:\"loading-indicator\",children:\" (\\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430...)\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:refreshRecommendations,className:\"refresh-button\",disabled:loadingRecs,children:\"\\u041F\\u043E\\u043A\\u0430\\u0437\\u0430\\u0442\\u044C \\u0434\\u0440\\u0443\\u0433\\u0438\\u0435\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"preference-tags\",children:[userPreferences.likedKeywords.slice(0,5).map(keyword=>/*#__PURE__*/_jsxs(\"span\",{className:\"like-tag\",children:[\"#\",keyword,\" \\u2713\"]},`like-${keyword}`)),userPreferences.dislikedKeywords.slice(0,3).map(keyword=>/*#__PURE__*/_jsxs(\"span\",{className:\"dislike-tag\",children:[\"#\",keyword,\" \\u2715\"]},`dislike-${keyword}`))]}),!loadingRecs&&recommendations.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"no-recs\",children:journalEntries.length>0?\"Не удалось найти рекомендации. Попробуйте добавить больше новостей.\":\"Добавьте новости в журнал, чтобы получить рекомендации\"}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(\"div\",{className:\"recommendations-grid\",children:recommendations.map((item,index)=>/*#__PURE__*/_jsxs(\"article\",{className:\"recommendation-card\",children:[item.imageUrl&&/*#__PURE__*/_jsx(\"div\",{className:\"image-container\",children:/*#__PURE__*/_jsx(\"img\",{src:getSafeImageUrl(item.imageUrl),alt:item.title,onError:()=>handleRecImageError(index)})}),/*#__PURE__*/_jsxs(\"div\",{className:\"rec-content\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"rec-title\",children:item.title}),/*#__PURE__*/_jsx(\"p\",{className:\"rec-description\",children:item.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"rec-footer\",children:[/*#__PURE__*/_jsx(\"a\",{href:item.url,target:\"_blank\",rel:\"noopener noreferrer\",className:\"rec-link\",children:\"\\u0427\\u0438\\u0442\\u0430\\u0442\\u044C\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"rec-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleLikeArticle(item),className:\"rec-like-button\",title:\"\\u041D\\u0440\\u0430\\u0432\\u0438\\u0442\\u0441\\u044F \\u044D\\u0442\\u0430 \\u0442\\u0435\\u043C\\u0430\",children:\"\\uD83D\\uDC4D\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDislikeArticle(item),className:\"dislike-button\",title:\"\\u041D\\u0435 \\u043D\\u0440\\u0430\\u0432\\u0438\\u0442\\u0441\\u044F \\u044D\\u0442\\u0430 \\u0442\\u0435\\u043C\\u0430\",children:\"\\uD83D\\uDC4E\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleAddToJournal(item),className:\"rec-add-button\",children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"})]})]})]})]},`rec-${index}`))})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"latest-news-section\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"latest-news-title\",children:\"\\u041F\\u043E\\u0441\\u043B\\u0435\\u0434\\u043D\\u0438\\u0435 \\u043D\\u043E\\u0432\\u043E\\u0441\\u0442\\u0438\"}),news.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"no-news\",children:\"\\u041D\\u0435\\u0442 \\u0434\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u044B\\u0445 \\u043D\\u043E\\u0432\\u043E\\u0441\\u0442\\u0435\\u0439\"}):/*#__PURE__*/_jsx(\"div\",{className:\"news-grid\",children:news.map((newsItem,index)=>{var _newsItem$source2;return/*#__PURE__*/_jsxs(\"article\",{className:\"news-card\",children:[newsItem.urlToImage&&/*#__PURE__*/_jsx(\"div\",{className:\"image-container\",children:/*#__PURE__*/_jsx(\"img\",{src:newsItem.urlToImage,alt:newsItem.title,className:\"news-image\",onError:()=>handleImageError(index)})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-content\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"news-title\",children:newsItem.title}),/*#__PURE__*/_jsx(\"p\",{className:\"news-description\",children:newsItem.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-footer\",children:[/*#__PURE__*/_jsx(\"a\",{href:newsItem.url,target:\"_blank\",rel:\"noopener noreferrer\",className:\"read-more\",children:\"\\u0427\\u0438\\u0442\\u0430\\u0442\\u044C \\u043F\\u043E\\u043B\\u043D\\u043E\\u0441\\u0442\\u044C\\u044E\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"action-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleLikeArticle(newsItem),className:\"like-button\",title:\"\\u041D\\u0440\\u0430\\u0432\\u0438\\u0442\\u0441\\u044F \\u044D\\u0442\\u0430 \\u0442\\u0435\\u043C\\u0430\",children:\"\\uD83D\\uDC4D\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDislikeArticle(newsItem),className:\"dislike-button\",title:\"\\u041D\\u0435 \\u043D\\u0440\\u0430\\u0432\\u0438\\u0442\\u0441\\u044F \\u044D\\u0442\\u0430 \\u0442\\u0435\\u043C\\u0430\",children:\"\\uD83D\\uDC4E\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleAddToJournal(newsItem),className:\"add-button\",children:\"\\u0421\\u043E\\u0445\\u0440\\u0430\\u043D\\u0438\\u0442\\u044C\"})]})]})]})]},`${((_newsItem$source2=newsItem.source)===null||_newsItem$source2===void 0?void 0:_newsItem$source2.id)||index}-${index}`);})})]})]})]});};export default NewsFeed;","map":{"version":3,"names":["React","useState","useEffect","axios","API","getSafeImageUrl","useNavigate","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","NewsFeed","news","setNews","recommendations","setRecommendations","journalEntries","setJournalEntries","loading","setLoading","loadingRecs","setLoadingRecs","error","setError","searchQuery","setSearchQuery","searchResults","setSearchResults","isSearching","setIsSearching","currentPage","setCurrentPage","totalResults","setTotalResults","pageSize","searchTimeout","setSearchTimeout","recPageSize","seenUrls","setSeenUrls","Set","userPreferences","setUserPreferences","likedKeywords","dislikedKeywords","preferredCategories","recommendationVersion","setRecommendationVersion","navigate","extractKeywords","title","arguments","length","undefined","description","text","toLowerCase","stopWords","words","split","filter","word","has","keywordFrequency","forEach","keywords","Object","keys","sort","a","b","slice","handlePageChange","newPage","Math","ceil","handleSearch","window","scrollTo","top","behavior","fetchNews","response","get","params","endpoint","country","data","articles","err","console","query","page","trim","_response$data","q","handleSearchChange","e","target","value","clearTimeout","timeoutId","setTimeout","categorizeContent","categories","test","push","handleLikeArticle","article","prev","refreshRecommendations","handleDislikeArticle","item","some","kw","includes","handleImageError","index","prevNews","_","i","handleRecImageError","prevRecs","fetchRecommendations","userId","localStorage","getItem","journalResponse","version","limit","join","uniqueRecommendations","url","newSet","add","handleAddToJournal","newsItem","_newsItem$source","token","alert","entryData","source","name","content","imageUrl","urlToImage","publishedAt","Date","toISOString","author","log","post","headers","Authorization","_err$response","_err$response$data","message","handleGoToJournal","className","children","type","placeholder","onChange","onClick","map","src","alt","onError","href","rel","now","disabled","Array","from","min","pageNum","keyword","_newsItem$source2","id"],"sources":["D:/Study/Course_rksp/frontend/src/components/NewsFeed.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport API from '../api';\r\nimport './NewsFeed.css';\r\nimport { getSafeImageUrl } from '../utils/imageUtils';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst NewsFeed = () => {\r\n  const [news, setNews] = useState([]);\r\n  const [recommendations, setRecommendations] = useState([]);\r\n  const [journalEntries, setJournalEntries] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [loadingRecs, setLoadingRecs] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [searchResults, setSearchResults] = useState([]);\r\n  const [isSearching, setIsSearching] = useState(false);\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [totalResults, setTotalResults] = useState(0);\r\n  const [pageSize] = useState(10);\r\n  const [searchTimeout, setSearchTimeout] = useState(null);\r\n  const [recPageSize] = useState(12); \r\n  const [seenUrls, setSeenUrls] = useState(new Set());\r\n  const [userPreferences, setUserPreferences] = useState({\r\n    likedKeywords: [],\r\n    dislikedKeywords: [],\r\n    preferredCategories: []\r\n  });\r\n  const [recommendationVersion, setRecommendationVersion] = useState(0);\r\n  const navigate = useNavigate();\r\n\r\n  // Функция извлечения ключевых слов\r\n  const extractKeywords = (title = '', description = '') => {\r\n    const text = `${title} ${description}`.toLowerCase();\r\n    const stopWords = new Set(['the', 'and', 'for', 'with', 'this', 'that', 'are', 'was']);\r\n    \r\n    const words = text.split(/\\W+/)\r\n      .filter(word => word.length > 3 && !stopWords.has(word));\r\n    \r\n    const keywordFrequency = {};\r\n    words.forEach(word => {\r\n      keywordFrequency[word] = (keywordFrequency[word] || 0) + 1;\r\n    });\r\n    \r\n    return {\r\n      keywords: Object.keys(keywordFrequency)\r\n        .sort((a, b) => keywordFrequency[b] - keywordFrequency[a])\r\n        .slice(0, 5)\r\n    };\r\n  };\r\n\r\n  const handlePageChange = (newPage) => {\r\n    if (newPage > 0 && newPage <= Math.ceil(totalResults / pageSize)) {\r\n      handleSearch(searchQuery, newPage);\r\n      window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    }\r\n  };\r\n\r\n  // Вместо прямых запросов к NewsAPI делайте так:\r\nconst fetchNews = async () => {\r\n  try {\r\n    const response = await API.get('/api/news/proxy/newsapi', {\r\n      params: {\r\n        endpoint: 'top-headlines',\r\n        country: 'us'\r\n      }\r\n    });\r\n    setNews(response.data.articles);\r\n  } catch (err) {\r\n    setError('Ошибка при загрузке новостей');\r\n    console.error(err);\r\n  } finally {\r\n    setLoading(false);\r\n  }\r\n};\r\n\r\nconst handleSearch = async (query, page = 1) => {\r\n  if (!query.trim()) {\r\n    setSearchResults([]);\r\n    setTotalResults(0);\r\n    return;\r\n  }\r\n\r\n  setIsSearching(true);\r\n  try {\r\n    const response = await API.get('/api/news/proxy/newsapi', {\r\n      params: {\r\n        endpoint: 'everything',\r\n        q: query,\r\n        page,\r\n        pageSize: pageSize\r\n      }\r\n    });\r\n    \r\n    if (response.data?.articles) {\r\n      setSearchResults(response.data.articles);\r\n      setTotalResults(response.data.totalResults);\r\n      setCurrentPage(page);\r\n    } else {\r\n      setSearchResults([]);\r\n      setTotalResults(0);\r\n    }\r\n  } catch (err) {\r\n    console.error('Search error:', err);\r\n    setSearchResults([]);\r\n    setTotalResults(0);\r\n  } finally {\r\n    setIsSearching(false);\r\n  }\r\n};\r\n\r\n\r\n\r\n\r\n  const handleSearchChange = (e) => {\r\n    const query = e.target.value;\r\n    setSearchQuery(query);\r\n    setCurrentPage(1);\r\n\r\n    // Очищаем предыдущий таймер\r\n    if (searchTimeout) {\r\n      clearTimeout(searchTimeout);\r\n    }\r\n\r\n    // Устанавливаем новый таймер только если запрос достаточно длинный\r\n    if (query.length > 2) {\r\n      const timeoutId = setTimeout(() => {\r\n        handleSearch(query, 1);\r\n      }, 2000);\r\n      \r\n      setSearchTimeout(timeoutId);\r\n    } else {\r\n      setSearchResults([]);\r\n      setTotalResults(0);\r\n    }\r\n  };\r\n\r\n  // Эффект для очистки таймера при размонтировании\r\n  useEffect(() => {\r\n    return () => {\r\n      if (searchTimeout) {\r\n        clearTimeout(searchTimeout);\r\n      }\r\n    };\r\n  }, [searchTimeout]);\r\n\r\n  // Функция категоризации\r\n  const categorizeContent = (title = '', description = '') => {\r\n    const text = `${title} ${description}`.toLowerCase();\r\n    const categories = [];\r\n    \r\n    if (/(tech|ai|robot|computer|software)/.test(text)) categories.push('technology');\r\n    if (/(business|market|economy|stock)/.test(text)) categories.push('business');\r\n    if (/(science|research|space|medicine)/.test(text)) categories.push('science');\r\n    if (/(politics|government|election)/.test(text)) categories.push('politics');\r\n    if (/(sport|football|basketball)/.test(text)) categories.push('sports');\r\n    if (/(game|gaming|esports|videogame|playstation|xbox|nintendo|steam|pc game)/.test(text)) categories.push('games');\r\n    \r\n    return categories.length > 0 ? categories : ['general'];\r\n  };\r\n\r\n  const handleLikeArticle = (article) => {\r\n    const { keywords } = extractKeywords(article.title, article.description);\r\n    setUserPreferences(prev => ({\r\n      ...prev,\r\n      likedKeywords: [...new Set([...prev.likedKeywords, ...keywords])],\r\n      preferredCategories: [\r\n        ...new Set([...prev.preferredCategories, ...categorizeContent(article.title, article.description)])\r\n      ]\r\n    }));\r\n    refreshRecommendations();\r\n  };\r\n  \r\n  const handleDislikeArticle = (article) => {\r\n    const { keywords } = extractKeywords(article.title, article.description);\r\n    setUserPreferences(prev => ({\r\n      ...prev,\r\n      dislikedKeywords: [...new Set([...prev.dislikedKeywords, ...keywords])]\r\n    }));\r\n    setRecommendations(prev => \r\n      prev.filter(item => \r\n        !keywords.some(kw => \r\n          item.title.toLowerCase().includes(kw.toLowerCase())\r\n        )\r\n      )\r\n    );\r\n    refreshRecommendations();\r\n  };\r\n\r\n\r\n  const handleImageError = (index) => {\r\n    setNews(prevNews => prevNews.filter((_, i) => i !== index));\r\n  };\r\n\r\n  const handleRecImageError = (index) => {\r\n    setRecommendations(prevRecs => prevRecs.filter((_, i) => i !== index));\r\n  };\r\n\r\n  const fetchRecommendations = async () => {\r\n    try {\r\n      const userId = localStorage.getItem('userId');\r\n      if (!userId) return;\r\n      \r\n      setLoadingRecs(true);\r\n      \r\n      const journalResponse = await API.get(`/api/news/${userId}/journal`);\r\n      setJournalEntries(journalResponse.data);\r\n      \r\n      const response = await API.get(`/api/news/recommendations/${userId}`, {\r\n        params: {\r\n          version: recommendationVersion,\r\n          limit: recPageSize, // Теперь запрашиваем больше новостей\r\n          likedKeywords: userPreferences.likedKeywords.join(','),\r\n          dislikedKeywords: userPreferences.dislikedKeywords.join(','),\r\n          preferredCategories: userPreferences.preferredCategories.join(',')\r\n        }\r\n      });\r\n      \r\n      if (response.data) {\r\n        // Фильтруем дубликаты по URL\r\n        const uniqueRecommendations = response.data.recommendations\r\n          .filter(item => !seenUrls.has(item.url));\r\n        \r\n        // Обновляем множество просмотренных URL\r\n        setSeenUrls(prev => {\r\n          const newSet = new Set(prev);\r\n          uniqueRecommendations.forEach(item => newSet.add(item.url));\r\n          return newSet;\r\n        });\r\n        \r\n        setRecommendations(uniqueRecommendations);\r\n      }\r\n    } catch (err) {\r\n      console.error('Ошибка загрузки рекомендаций:', err);\r\n    } finally {\r\n      setLoadingRecs(false);\r\n    }\r\n  };\r\n\r\n  // Обновляем функцию обновления рекомендаций\r\n  const refreshRecommendations = () => {\r\n    setSeenUrls(new Set()); // Очищаем просмотренные URL\r\n    setRecommendationVersion(prev => prev + 1);\r\n  };\r\n\r\n\r\n  const handleAddToJournal = async (newsItem) => {\r\n    try {\r\n      const userId = localStorage.getItem('userId');\r\n      const token = localStorage.getItem('token');\r\n  \r\n      if (!userId || !token) {\r\n        alert('Для добавления в журнал необходимо авторизоваться');\r\n        return;\r\n      }\r\n  \r\n      const { keywords } = extractKeywords(newsItem.title, newsItem.description);\r\n      const categories = categorizeContent(newsItem.title, newsItem.description);\r\n  \r\n      // Убедимся, что все поля передаются, включая imageUrl\r\n      const entryData = {\r\n        userId,\r\n        url: newsItem.url,\r\n        source: newsItem.source?.name || 'unknown',\r\n        title: newsItem.title || '',\r\n        description: newsItem.description || '',\r\n        content: newsItem.content || newsItem.description || '',\r\n        imageUrl: newsItem.urlToImage || newsItem.imageUrl || '', // Добавлено резервное значение\r\n        publishedAt: newsItem.publishedAt || new Date().toISOString(),\r\n        author: newsItem.author || '',\r\n        keywords,\r\n        categories\r\n      };\r\n  \r\n      console.log('Отправляемые данные:', entryData); // Для отладки\r\n  \r\n      await API.post('/api/news/journal', entryData, {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`\r\n        }\r\n      });\r\n  \r\n      alert('Новость успешно добавлена в журнал');\r\n      fetchRecommendations();\r\n    } catch (err) {\r\n      console.error('Ошибка добавления:', err);\r\n      alert(err.response?.data?.message || 'Ошибка при добавлении в журнал');\r\n    }\r\n  };\r\n\r\n\r\n  const handleGoToJournal = () => {\r\n    navigate('/journal');\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchNews();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchRecommendations();\r\n  }, [recommendationVersion, userPreferences]);\r\n\r\n  if (loading) return <div className=\"loading\">Загрузка новостей...</div>;\r\n  if (error) return <div className=\"error\">{error}</div>;\r\n\r\n  return (\r\n    <div className=\"news-feed\">\r\n      <div className=\"news-feed-header\">\r\n        <h2 className=\"news-feed-title\">Новостная лента</h2>\r\n        <div className=\"search-container\">\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Поиск новостей...\"\r\n            value={searchQuery}\r\n            onChange={handleSearchChange}\r\n            className=\"search-input\"\r\n          />\r\n          {isSearching && <div className=\"search-spinner\">Загрузка...</div>}\r\n        </div>\r\n        <button \r\n          onClick={handleGoToJournal}\r\n          className=\"journal-button\"\r\n        >\r\n          Мой журнал\r\n        </button>\r\n      </div>\r\n      \r\n      {/* Показываем результаты поиска, если они есть */}\r\n      {searchResults.length > 0 ? (\r\n        <div className=\"search-results-section\">\r\n          <h3 className=\"search-results-title\">\r\n            Результаты поиска по запросу: \"{searchQuery}\" ({totalResults} найдено)\r\n          </h3>\r\n          <div className=\"news-grid\">\r\n            {searchResults.map((newsItem, index) => (\r\n              <article key={`search-${index}-${Date.now()}`} className=\"news-card\">\r\n                {newsItem.urlToImage && (\r\n                  <div className=\"image-container\">\r\n                    <img \r\n                      src={newsItem.urlToImage} \r\n                      alt={newsItem.title} \r\n                      className=\"news-image\"\r\n                      onError={() => handleImageError(index)}\r\n                    />\r\n                  </div>\r\n                )}\r\n                <div className=\"card-content\">\r\n                  <h3 className=\"news-title\">{newsItem.title}</h3>\r\n                  <p className=\"news-description\">{newsItem.description}</p>\r\n                  <div className=\"card-footer\">\r\n                    <a \r\n                      href={newsItem.url} \r\n                      target=\"_blank\" \r\n                      rel=\"noopener noreferrer\"\r\n                      className=\"read-more\"\r\n                    >\r\n                      Читать полностью\r\n                    </a>\r\n                    <div className=\"action-buttons\">\r\n                      <button \r\n                        onClick={() => handleLikeArticle(newsItem)}\r\n                        className=\"like-button\"\r\n                        title=\"Нравится эта тема\"\r\n                      >\r\n                        👍\r\n                      </button>\r\n                      <button \r\n                        onClick={() => handleDislikeArticle(newsItem)}\r\n                        className=\"dislike-button\"\r\n                        title=\"Не нравится эта тема\"\r\n                      >\r\n                        👎\r\n                      </button>\r\n                      <button \r\n                        onClick={() => handleAddToJournal(newsItem)}\r\n                        className=\"add-button\"\r\n                      >\r\n                        Сохранить\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </article>\r\n            ))}\r\n          </div>\r\n  \r\n          {/* Пагинация для результатов поиска */}\r\n          {totalResults > pageSize && (\r\n            <div className=\"pagination\">\r\n              <button\r\n                onClick={() => handlePageChange(currentPage - 1)}\r\n                disabled={currentPage === 1 || isSearching}\r\n                className=\"pagination-button\"\r\n              >\r\n                Назад\r\n              </button>\r\n              \r\n              <div className=\"page-numbers\">\r\n                {Array.from({ length: Math.min(5, Math.ceil(totalResults / pageSize)) }, (_, i) => {\r\n                  let pageNum;\r\n                  if (Math.ceil(totalResults / pageSize) <= 5) {\r\n                    pageNum = i + 1;\r\n                  } else if (currentPage <= 3) {\r\n                    pageNum = i + 1;\r\n                  } else if (currentPage >= Math.ceil(totalResults / pageSize) - 2) {\r\n                    pageNum = Math.ceil(totalResults / pageSize) - 4 + i;\r\n                  } else {\r\n                    pageNum = currentPage - 2 + i;\r\n                  }\r\n                  \r\n                  return (\r\n                    <button\r\n                      key={pageNum}\r\n                      onClick={() => handlePageChange(pageNum)}\r\n                      disabled={isSearching}\r\n                      className={`page-button ${currentPage === pageNum ? 'active' : ''}`}\r\n                    >\r\n                      {pageNum}\r\n                    </button>\r\n                  );\r\n                })}\r\n              </div>\r\n              \r\n              <button\r\n                onClick={() => handlePageChange(currentPage + 1)}\r\n                disabled={currentPage === Math.ceil(totalResults / pageSize) || isSearching}\r\n                className=\"pagination-button\"\r\n              >\r\n                Вперед\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      ) : (\r\n        /* Показываем рекомендации и новости, если нет поискового запроса */\r\n        <>\r\n          {/* Блок рекомендаций теперь идет первым */}\r\n          <div className=\"recommendations-section\">\r\n            <div className=\"recommendations-header\">\r\n              <h2 className=\"recommendations-title\">\r\n                Рекомендуем вам\r\n                {loadingRecs && <span className=\"loading-indicator\"> (загрузка...)</span>}\r\n              </h2>\r\n              <button \r\n                onClick={refreshRecommendations}\r\n                className=\"refresh-button\"\r\n                disabled={loadingRecs}\r\n              >\r\n                Показать другие\r\n              </button>\r\n            </div>\r\n            \r\n            <div className=\"preference-tags\">\r\n              {userPreferences.likedKeywords.slice(0, 5).map(keyword => (\r\n                <span key={`like-${keyword}`} className=\"like-tag\">\r\n                  #{keyword} ✓\r\n                </span>\r\n              ))}\r\n              {userPreferences.dislikedKeywords.slice(0, 3).map(keyword => (\r\n                <span key={`dislike-${keyword}`} className=\"dislike-tag\">\r\n                  #{keyword} ✕\r\n                </span>\r\n              ))}\r\n            </div>\r\n            \r\n            {!loadingRecs && recommendations.length === 0 ? (\r\n              <p className=\"no-recs\">\r\n                {journalEntries.length > 0 \r\n                  ? \"Не удалось найти рекомендации. Попробуйте добавить больше новостей.\"\r\n                  : \"Добавьте новости в журнал, чтобы получить рекомендации\"}\r\n              </p>\r\n            ) : (\r\n              <>\r\n                <div className=\"recommendations-grid\">\r\n                  {recommendations.map((item, index) => (\r\n                    <article key={`rec-${index}`} className=\"recommendation-card\">\r\n                      {item.imageUrl && (\r\n                        <div className=\"image-container\">\r\n                          <img \r\n                            src={getSafeImageUrl(item.imageUrl)} \r\n                            alt={item.title}\r\n                            onError={() => handleRecImageError(index)}\r\n                          />\r\n                        </div>\r\n                      )}\r\n                      <div className=\"rec-content\">\r\n                        <h3 className=\"rec-title\">{item.title}</h3>\r\n                        <p className=\"rec-description\">{item.description}</p>\r\n                        <div className=\"rec-footer\">\r\n                          <a \r\n                            href={item.url} \r\n                            target=\"_blank\" \r\n                            rel=\"noopener noreferrer\"\r\n                            className=\"rec-link\"\r\n                          >\r\n                            Читать\r\n                          </a>\r\n                          <div className=\"rec-actions\">\r\n                            <button \r\n                              onClick={() => handleLikeArticle(item)}\r\n                              className=\"rec-like-button\"\r\n                              title=\"Нравится эта тема\"\r\n                            >\r\n                              👍\r\n                            </button>\r\n                            <button \r\n                              onClick={() => handleDislikeArticle(item)}\r\n                              className=\"dislike-button\"\r\n                              title=\"Не нравится эта тема\"\r\n                            >\r\n                              👎\r\n                            </button>\r\n                            <button \r\n                              onClick={() => handleAddToJournal(item)}\r\n                              className=\"rec-add-button\"\r\n                            >\r\n                              Сохранить\r\n                            </button>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </article>\r\n                  ))}\r\n                </div>\r\n              </>\r\n            )}\r\n          </div>\r\n  \r\n          {/* Блок последних новостей теперь идет после рекомендаций */}\r\n          <div className=\"latest-news-section\">\r\n            <h2 className=\"latest-news-title\">Последние новости</h2>\r\n            \r\n            {news.length === 0 ? (\r\n              <p className=\"no-news\">Нет доступных новостей</p>\r\n            ) : (\r\n              <div className=\"news-grid\">\r\n                {news.map((newsItem, index) => (\r\n                  <article key={`${newsItem.source?.id || index}-${index}`} className=\"news-card\">\r\n                    {newsItem.urlToImage && (\r\n                      <div className=\"image-container\">\r\n                        <img \r\n                          src={newsItem.urlToImage} \r\n                          alt={newsItem.title} \r\n                          className=\"news-image\"\r\n                          onError={() => handleImageError(index)}\r\n                        />\r\n                      </div>\r\n                    )}\r\n                    <div className=\"card-content\">\r\n                      <h3 className=\"news-title\">{newsItem.title}</h3>\r\n                      <p className=\"news-description\">{newsItem.description}</p>\r\n                      <div className=\"card-footer\">\r\n                        <a \r\n                          href={newsItem.url} \r\n                          target=\"_blank\" \r\n                          rel=\"noopener noreferrer\"\r\n                          className=\"read-more\"\r\n                        >\r\n                          Читать полностью\r\n                        </a>\r\n                        <div className=\"action-buttons\">\r\n                          <button \r\n                            onClick={() => handleLikeArticle(newsItem)}\r\n                            className=\"like-button\"\r\n                            title=\"Нравится эта тема\"\r\n                          >\r\n                            👍\r\n                          </button>\r\n                          <button \r\n                            onClick={() => handleDislikeArticle(newsItem)}\r\n                            className=\"dislike-button\"\r\n                            title=\"Не нравится эта тема\"\r\n                          >\r\n                            👎\r\n                          </button>\r\n                          <button \r\n                            onClick={() => handleAddToJournal(newsItem)}\r\n                            className=\"add-button\"\r\n                          >\r\n                            Сохранить\r\n                          </button>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  </article>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default NewsFeed;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}