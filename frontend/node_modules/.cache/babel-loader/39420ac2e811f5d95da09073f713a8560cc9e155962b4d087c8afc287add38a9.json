{"ast":null,"code":"import React from'react';import{useNavigate}from'react-router-dom';import API from'../api';import AuthForm from'../components/AuthForm';import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";const LoginPage=()=>{const navigate=useNavigate();const handleLogin=async formData=>{try{const response=await API.post('/api/auth/login',{email:formData.email,password:formData.password});console.log('USER DATA:',response.data.user);// üëà –ø–æ—Å–º–æ—Ç—Ä–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏\nconst user=response.data.user;const userId=user._id||user.id;localStorage.setItem('user',JSON.stringify(user));localStorage.setItem('userId',userId);// üëà –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ id –Ω–µ undefined\nlocalStorage.setItem('token',response.data.token);alert('–í—ã —É—Å–ø–µ—à–Ω–æ –≤–æ—à–ª–∏!');window.location.href='/news';}catch(err){var _err$response,_err$response$data,_err$response2,_err$response2$data,_err$response3;const errorMessage=((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.error)||'–û—à–∏–±–∫–∞ –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏';alert(errorMessage);console.error('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:',((_err$response3=err.response)===null||_err$response3===void 0?void 0:_err$response3.data)||err);}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0412\\u0445\\u043E\\u0434\"}),/*#__PURE__*/_jsx(AuthForm,{type:\"login\",onSubmit:handleLogin})]});};export default LoginPage;","map":{"version":3,"names":["React","useNavigate","API","AuthForm","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","LoginPage","navigate","handleLogin","formData","response","post","email","password","console","log","data","user","userId","_id","id","localStorage","setItem","JSON","stringify","token","alert","window","location","href","err","_err$response","_err$response$data","_err$response2","_err$response2$data","_err$response3","errorMessage","message","error","children","type","onSubmit"],"sources":["D:/Study/Course_rksp/frontend/src/pages/LoginPage.jsx"],"sourcesContent":["import React from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport API from '../api';\r\nimport AuthForm from '../components/AuthForm';\r\n\r\nconst LoginPage = () => {\r\n    const navigate = useNavigate();\r\n  \r\n    const handleLogin = async (formData) => {\r\n      try {\r\n        const response = await API.post('/api/auth/login', {\r\n          email: formData.email,\r\n          password: formData.password\r\n        });\r\n    \r\n        console.log('USER DATA:', response.data.user); // üëà –ø–æ—Å–º–æ—Ç—Ä–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏\r\n    \r\n        const user = response.data.user;\r\n        const userId = user._id || user.id;\r\n    \r\n        localStorage.setItem('user', JSON.stringify(user));\r\n        localStorage.setItem('userId', userId); // üëà –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ id –Ω–µ undefined\r\n        localStorage.setItem('token', response.data.token);\r\n    \r\n        alert('–í—ã —É—Å–ø–µ—à–Ω–æ –≤–æ—à–ª–∏!');\r\n        window.location.href = '/news';\r\n      } catch (err) {\r\n        const errorMessage = err.response?.data?.message ||\r\n                             err.response?.data?.error ||\r\n                             '–û—à–∏–±–∫–∞ –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏';\r\n        alert(errorMessage);\r\n        console.error('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:', err.response?.data || err);\r\n      }\r\n    };\r\n    \r\n\r\n      \r\n      \r\n  \r\n    return (\r\n      <>\r\n        <h2>–í—Ö–æ–¥</h2>\r\n        <AuthForm type=\"login\" onSubmit={handleLogin} />\r\n      </>\r\n    );\r\n  };\r\n\r\nexport default LoginPage;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,MAAO,CAAAC,GAAG,KAAM,QAAQ,CACxB,MAAO,CAAAC,QAAQ,KAAM,wBAAwB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,QAAA,IAAAC,SAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE9C,KAAM,CAAAC,SAAS,CAAGA,CAAA,GAAM,CACpB,KAAM,CAAAC,QAAQ,CAAGV,WAAW,CAAC,CAAC,CAE9B,KAAM,CAAAW,WAAW,CAAG,KAAO,CAAAC,QAAQ,EAAK,CACtC,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAZ,GAAG,CAACa,IAAI,CAAC,iBAAiB,CAAE,CACjDC,KAAK,CAAEH,QAAQ,CAACG,KAAK,CACrBC,QAAQ,CAAEJ,QAAQ,CAACI,QACrB,CAAC,CAAC,CAEFC,OAAO,CAACC,GAAG,CAAC,YAAY,CAAEL,QAAQ,CAACM,IAAI,CAACC,IAAI,CAAC,CAAE;AAE/C,KAAM,CAAAA,IAAI,CAAGP,QAAQ,CAACM,IAAI,CAACC,IAAI,CAC/B,KAAM,CAAAC,MAAM,CAAGD,IAAI,CAACE,GAAG,EAAIF,IAAI,CAACG,EAAE,CAElCC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAEC,IAAI,CAACC,SAAS,CAACP,IAAI,CAAC,CAAC,CAClDI,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAEJ,MAAM,CAAC,CAAE;AACxCG,YAAY,CAACC,OAAO,CAAC,OAAO,CAAEZ,QAAQ,CAACM,IAAI,CAACS,KAAK,CAAC,CAElDC,KAAK,CAAC,mBAAmB,CAAC,CAC1BC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAG,OAAO,CAChC,CAAE,MAAOC,GAAG,CAAE,KAAAC,aAAA,CAAAC,kBAAA,CAAAC,cAAA,CAAAC,mBAAA,CAAAC,cAAA,CACZ,KAAM,CAAAC,YAAY,CAAG,EAAAL,aAAA,CAAAD,GAAG,CAACpB,QAAQ,UAAAqB,aAAA,kBAAAC,kBAAA,CAAZD,aAAA,CAAcf,IAAI,UAAAgB,kBAAA,iBAAlBA,kBAAA,CAAoBK,OAAO,KAAAJ,cAAA,CAC3BH,GAAG,CAACpB,QAAQ,UAAAuB,cAAA,kBAAAC,mBAAA,CAAZD,cAAA,CAAcjB,IAAI,UAAAkB,mBAAA,iBAAlBA,mBAAA,CAAoBI,KAAK,GACzB,wBAAwB,CAC7CZ,KAAK,CAACU,YAAY,CAAC,CACnBtB,OAAO,CAACwB,KAAK,CAAC,eAAe,CAAE,EAAAH,cAAA,CAAAL,GAAG,CAACpB,QAAQ,UAAAyB,cAAA,iBAAZA,cAAA,CAAcnB,IAAI,GAAIc,GAAG,CAAC,CAC3D,CACF,CAAC,CAMD,mBACEzB,KAAA,CAAAF,SAAA,EAAAoC,QAAA,eACEtC,IAAA,OAAAsC,QAAA,CAAI,0BAAI,CAAI,CAAC,cACbtC,IAAA,CAACF,QAAQ,EAACyC,IAAI,CAAC,OAAO,CAACC,QAAQ,CAAEjC,WAAY,CAAE,CAAC,EAChD,CAAC,CAEP,CAAC,CAEH,cAAe,CAAAF,SAAS","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}